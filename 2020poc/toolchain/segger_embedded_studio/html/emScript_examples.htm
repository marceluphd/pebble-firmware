<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
  <head>
    <title>Example uses</title>
    <meta content="text/html; charset=UTF-8" http-equiv="Content-Type"/>
    <meta content="RAL PrepHTML" name="GENERATOR"/>
    
    
    <link rel="STYLESHEET" type="text/css" href="./rwt/styles/ses-default.css"/>
    <link rel="STYLESHEET" type="text/css" href="./rwt/styles/ses.css"/>
    <link rel="STYLESHEET" type="text/css" href="./rwt/styles/rwt-doc-page.css"/>
    <link rel="STYLESHEET" type="text/css" href="./rwt/styles/theme.css"/>
    <script type="text/javascript" language="javascript" src="./rwt/scripts/jquery-latest.js"><!--><-->
</script>
    <script type="text/javascript" language="javascript" src="./rwt/scripts/rwt.js"><!--><-->
</script>
    <script type="text/javascript" language="javascript" src="./rwt/scripts/rwt-doc-page.js"><!--><-->
</script>
    
  </head>

  <body>
    <div id="rwt-content">
      
<p>The following example demonstrates using <b>emScript</b> to increment
a build number:</p><p>First, add a JavaScript file to your project called <tt>incbuild.js</tt>
containing the following code:</p>
<pre class="rwt-code"><span class="rwt-code-keyword">function</span><span class="rwt-code-text"> </span><span class="rwt-code-function">incbuild</span><span class="rwt-code-operator">()</span>
<span class="rwt-code-operator">{</span>
  <span class="rwt-code-keyword">var</span><span class="rwt-code-text"> </span><span class="rwt-code-text">file </span><span class="rwt-code-operator">=</span><span class="rwt-code-text"> </span><span class="rwt-code-literal">"buildnum.h"</span>
  <span class="rwt-code-keyword">var</span><span class="rwt-code-text"> </span><span class="rwt-code-text">text </span><span class="rwt-code-operator">=</span><span class="rwt-code-text"> </span><span class="rwt-code-literal">"#define BUILDNUMBER "</span>
  <span class="rwt-code-keyword">var</span><span class="rwt-code-text"> </span><span class="rwt-code-text">s </span><span class="rwt-code-operator">=</span><span class="rwt-code-text"> </span><span class="rwt-code-text">CWSys</span><span class="rwt-code-operator">.</span><span class="rwt-code-function">readStringFromFile</span><span class="rwt-code-operator">(</span><span class="rwt-code-text">file</span><span class="rwt-code-operator">);</span>
  <span class="rwt-code-keyword">var</span><span class="rwt-code-text"> </span><span class="rwt-code-text">n</span><span class="rwt-code-operator">;</span>
  <span class="rwt-code-keyword">if</span><span class="rwt-code-function"> </span><span class="rwt-code-operator">(</span><span class="rwt-code-text">s </span><span class="rwt-code-operator">==</span><span class="rwt-code-text"> </span><span class="rwt-code-text">undefined</span><span class="rwt-code-operator">)</span>
    <span class="rwt-code-text">n </span><span class="rwt-code-operator">=</span><span class="rwt-code-text"> </span><span class="rwt-code-literal">1</span><span class="rwt-code-operator">;</span>
  <span class="rwt-code-keyword">else</span>
    <span class="rwt-code-text">n </span><span class="rwt-code-operator">=</span><span class="rwt-code-text"> </span><span class="rwt-code-function">eval</span><span class="rwt-code-operator">(</span><span class="rwt-code-text">s</span><span class="rwt-code-operator">.</span><span class="rwt-code-function">substring</span><span class="rwt-code-operator">(</span><span class="rwt-code-text">text</span><span class="rwt-code-operator">.</span><span class="rwt-code-text">length</span><span class="rwt-code-operator">))</span><span class="rwt-code-text"> </span><span class="rwt-code-operator">+</span><span class="rwt-code-text"> </span><span class="rwt-code-literal">1</span><span class="rwt-code-operator">;</span>
  <span class="rwt-code-text">CWSys</span><span class="rwt-code-operator">.</span><span class="rwt-code-function">writeStringToFile</span><span class="rwt-code-operator">(</span><span class="rwt-code-text">file</span><span class="rwt-code-operator">,</span><span class="rwt-code-text"> </span><span class="rwt-code-text">text </span><span class="rwt-code-operator">+</span><span class="rwt-code-text"> </span><span class="rwt-code-text">n</span><span class="rwt-code-operator">);</span>
<span class="rwt-code-operator">}</span>

<span class="rwt-code-comment">// </span><span class="rwt-code-comment">Executed </span><span class="rwt-code-comment">when </span><span class="rwt-code-comment">script </span><span class="rwt-code-comment">loaded.</span>
<span class="rwt-code-function">incbuild</span><span class="rwt-code-operator">();</span></pre><p>Add a file called <tt>getbuildnum.h</tt> to your project
containing the following code:</p>
<pre class="rwt-code"><span class="rwt-code-control">#ifndef</span><span class="rwt-code-text"> </span><span class="rwt-code-text">GETBUILDNUM_H</span>
<span class="rwt-code-control">#define</span><span class="rwt-code-text"> </span><span class="rwt-code-text">GETBUILDNUM_H</span>

<span class="rwt-code-keyword">unsigned</span><span class="rwt-code-text"> </span><span class="rwt-code-function">getBuildNumber</span><span class="rwt-code-operator">();</span>

<span class="rwt-code-control">#endif</span><span class="rwt-code-text"/></pre><p>Add a file called <tt>getbuildnum.c</tt> to your project
containing the following code:</p>
<pre class="rwt-code"><span class="rwt-code-control">#include</span><span class="rwt-code-text"> </span><span class="rwt-code-literal">"getbuildnum.h"</span>
<span class="rwt-code-control">#include</span><span class="rwt-code-text"> </span><span class="rwt-code-literal">"buildnum.h"</span>

<span class="rwt-code-keyword">unsigned</span><span class="rwt-code-text"> </span><span class="rwt-code-function">getBuildNumber</span><span class="rwt-code-operator">()</span>
<span class="rwt-code-operator">{</span>
  <span class="rwt-code-keyword">return</span><span class="rwt-code-text"> </span><span class="rwt-code-text">BUILDNUMBER</span><span class="rwt-code-operator">;</span>
<span class="rwt-code-operator">}</span></pre><p>Now, to combine these:</p><ul><li>Set the <b>Build Options > Always Rebuild</b> project property
  of <tt>getbuildnum.c</tt> to <b>Yes</b>.
</li>
<li>Set the <b>User Build Step Options > Pre-Compile Command</b> project
  property of <tt>getbuildnum.c</tt> to <b>"$(StudioDir)/bin/emScript" -load "$(ProjectDir)/incbuild.js"</b>.</li></ul> 
    </div>
  </body>
</html>